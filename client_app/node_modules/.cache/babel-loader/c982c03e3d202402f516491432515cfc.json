{"ast":null,"code":"import { File } from 'better-xlsx';\nimport { saveAs } from 'file-saver';\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n\n  return target;\n}\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n  return arr2;\n}\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) {\n  var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"];\n\n  if (!it) {\n    if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n      if (it) o = it;\n      var i = 0;\n\n      var F = function () {};\n\n      return {\n        s: F,\n        n: function () {\n          if (i >= o.length) return {\n            done: true\n          };\n          return {\n            done: false,\n            value: o[i++]\n          };\n        },\n        e: function (e) {\n          throw e;\n        },\n        f: F\n      };\n    }\n\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  var normalCompletion = true,\n      didErr = false,\n      err;\n  return {\n    s: function () {\n      it = it.call(o);\n    },\n    n: function () {\n      var step = it.next();\n      normalCompletion = step.done;\n      return step;\n    },\n    e: function (e) {\n      didErr = true;\n      err = e;\n    },\n    f: function () {\n      try {\n        if (!normalCompletion && it.return != null) it.return();\n      } finally {\n        if (didErr) throw err;\n      }\n    }\n  };\n}\n\nfunction getDefaultFontName() {\n  var _navigator;\n\n  if (typeof navigator === 'undefined') return 'Microsoft YaHei';\n  var isMac = /macintosh|mac os x/i.test((_navigator = navigator) === null || _navigator === void 0 ? void 0 : _navigator.userAgent.toLowerCase());\n  return isMac ? 'PingFang SC' : 'Microsoft YaHei';\n}\n\nvar STYLEMAP = {\n  border: function border(cell) {\n    var style = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var border = style.border;\n    var borderColor = style.borderColor || 'FF000000';\n    if (!border) return;\n    cell.style.border.top = 'thin';\n    cell.style.border.topColor = borderColor;\n    cell.style.border.right = 'thin';\n    cell.style.border.rightColor = borderColor;\n    cell.style.border.bottom = 'thin';\n    cell.style.border.bottomColor = borderColor;\n    cell.style.border.left = 'thin';\n    cell.style.border.leftColor = borderColor;\n  },\n  background: function background(cell) {\n    var style = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var background = style.background;\n\n    if (background) {\n      // FF 表示不透明 00 表示透明\n      // fg 前景色 bg 背景色\n      cell.style.fill.patternType = 'solid';\n      cell.style.fill.fgColor = background;\n      cell.style.fill.bgColor = 'ffffffff';\n    }\n  },\n  fontSize: function fontSize(cell) {\n    var style = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var fontSize = style.fontSize;\n\n    if (fontSize) {\n      cell.style.font.size = fontSize;\n    }\n  },\n  fontName: function fontName(cell) {\n    var style = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var fontName = style.fontName;\n\n    if (fontName) {\n      cell.style.font.name = fontName;\n    }\n  },\n  color: function color(cell) {\n    var style = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var color = style.color;\n\n    if (color) {\n      cell.style.font.color = color;\n    }\n  },\n  bold: function bold(cell) {\n    var style = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var bold = style.bold;\n\n    if (bold) {\n      cell.style.font.bold = bold;\n    }\n  },\n  i: function i(cell) {\n    var style = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var i = style.i;\n\n    if (i) {\n      cell.style.font.i = i;\n    }\n  },\n  u: function u(cell) {\n    var style = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var u = style.u;\n\n    if (u) {\n      cell.style.font.u = u;\n    }\n  },\n  h: function h(cell) {\n    var style = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var h = style.h;\n\n    if (h) {\n      cell.style.align.h = h;\n    }\n  },\n  indent: function indent(cell) {\n    var style = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var indent = style.indent;\n\n    if (indent) {\n      cell.style.align.indent = indent;\n    }\n  },\n  shrinkToFit: function shrinkToFit(cell) {\n    var style = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var shrinkToFit = style.shrinkToFit;\n\n    if (shrinkToFit) {\n      cell.style.align.shrinkToFit = shrinkToFit;\n    }\n  },\n  textRotation: function textRotation(cell) {\n    var style = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var textRotation = style.textRotation;\n\n    if (textRotation) {\n      cell.style.align.textRotation = textRotation;\n    }\n  },\n  v: function v(cell) {\n    var style = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var v = style.v;\n\n    if (v) {\n      cell.style.align.v = v;\n    }\n  },\n  wrapText: function wrapText(cell) {\n    var style = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var wrapText = style.wrapText;\n\n    if (wrapText) {\n      cell.style.align.wrapText = wrapText;\n    }\n  }\n};\n\nfunction setStyle(cell) {\n  var style = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var fontName = style.fontName;\n\n  if (!fontName) {\n    cell.style.font.name = getDefaultFontName();\n  }\n\n  for (var _i = 0, _Object$keys = Object.keys(style); _i < _Object$keys.length; _i++) {\n    var key = _Object$keys[_i];\n\n    if (key in STYLEMAP) {\n      //@ts-ignore\n      STYLEMAP[key](cell, style);\n    }\n  }\n}\n\nfunction drawCell(cell, props) {\n  var config = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var value = props.value,\n      _props$hMerge = props.hMerge,\n      hMerge = _props$hMerge === void 0 ? 0 : _props$hMerge,\n      _props$vMerge = props.vMerge,\n      vMerge = _props$vMerge === void 0 ? 0 : _props$vMerge,\n      numFmt = props.numFmt,\n      formula = props.formula,\n      cellType = props.cellType,\n      _props$style = props.style,\n      style = _props$style === void 0 ? {} : _props$style;\n  var str2num = config.str2num,\n      str2Percent = config.str2Percent; // 尝试将值转化为数字\n\n  if (str2num) {\n    var num = Number(value);\n\n    if (!isNaN(num)) {\n      cell.value = num;\n    } else {\n      // 可能是千分位\n      var _num = String(value).replaceAll(',', '');\n\n      var isThousand = !isNaN(Number(_num));\n\n      if (isThousand) {\n        cell.value = Number(_num);\n        cell.numFmt = thousandToNumFmt(_num);\n      } else {\n        cell.value = value;\n      }\n    }\n  } else {\n    cell.value = value;\n  }\n\n  if (str2Percent && String(value).endsWith('%')) {\n    // 可以转化为百分比的话进行设置\n    var _num2 = Number(String(value).slice(0, -1));\n\n    if (!isNaN(_num2)) {\n      cell.value = Number(_num2) / 100;\n      cell.numFmt = percentToNumFmt(_num2);\n    }\n  } // 声明了公式\n\n\n  if (formula) {\n    cell.setFormula(formula);\n    return;\n  } // 指定了单元格类型\n\n\n  if (cellType) {\n    if (cellType === 'TypeDate') {\n      cell.setDate(new Date(value));\n    } else {\n      cell.cellType = cellType;\n    } // return;\n\n  } // 指定了单元格格式\n\n\n  if (numFmt) {\n    cell.numFmt = numFmt;\n  } // 合并\n\n\n  cell.hMerge = hMerge;\n  cell.vMerge = vMerge;\n\n  if (vMerge) {\n    style.v = 'center';\n  }\n\n  setStyle(cell, style);\n}\n\nfunction getDecimal(data) {\n  var str = String(data);\n  var pointIndex = str.indexOf('.');\n  if (pointIndex === -1) return 0;\n  var decimalPart = str.slice(pointIndex + 1);\n  return decimalPart.length;\n}\n\nfunction thousandToNumFmt(data) {\n  var decimal = getDecimal(data);\n  var numFmts = ['#,##0', '#,##0.0', '#,##0.00', '#,##0.000', '#,##0.0000'];\n  return numFmts[decimal] || numFmts[4];\n}\n\nfunction percentToNumFmt(data) {\n  var decimal = getDecimal(data);\n  var numFmts = ['0%', '0.0%', '0.00%', '0.000%', '0.0000%'];\n  return numFmts[decimal] || numFmts[2];\n} // export interface ITreeNode {\n//   title: string;\n//   x: number;\n//   xMerge: number;\n//   vMerge: number;\n//   children: ITreeNode[] | null;\n// }\n\n\nfunction columnsFilter(columns) {\n  return columns.filter(function (col) {\n    if (col.__ignore__) return false;\n\n    if (col.children) {\n      col.children = columnsFilter(col.children);\n    }\n\n    return true;\n  });\n}\n\nfunction getColumnsMaxDepth(columns) {\n  var depth = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n  var maxs = columns.map(function (col) {\n    return getColumnDepth(col, depth);\n  });\n  return Math.max.apply(Math, maxs);\n}\n\nfunction getColumnDepth(column) {\n  var depth = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n\n  if (column.children) {\n    return getColumnsMaxDepth(column.children, depth + 1);\n  }\n\n  return depth;\n}\n\nfunction getColumnsMaxLength(columns) {\n  return columns.reduce(function (prev, cur) {\n    return prev + getColumnLength(cur);\n  }, 0);\n}\n\nfunction getColumnLength(column) {\n  if (column.children) {\n    return getColumnsMaxLength(column.children);\n  }\n\n  return 1;\n}\n\nfunction flatColumns(columns) {\n  return columns.reduce(function (prev, cur) {\n    return prev.concat(flatColumn(cur));\n  }, []);\n}\n\nfunction flatColumn(column) {\n  if (column.children) {\n    return flatColumns(column.children);\n  }\n\n  return [column];\n}\n/**\r\n * 渲染表格头\r\n * @param excel TExcel\r\n * @param columns 传入的表头配置，antd table columns props\r\n * @param style 表头样式\r\n * @param depth 表头深度\r\n * @param x 开始绘制的单元格，第几列\r\n * @param y 开始绘制的单元格，第几行\r\n */\n\n\nfunction renderThead(excel, columns, style, depth) {\n  var x = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 0;\n  var y = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 0;\n\n  var _iterator = _createForOfIteratorHelper(columns),\n      _step;\n\n  try {\n    for (_iterator.s(); !(_step = _iterator.n()).done;) {\n      var _col$children, _col$children2;\n\n      var col = _step.value;\n      var colLen = getColumnsMaxLength([col]);\n      var cell = excel.sheet.cell(y, x);\n      var value = '';\n\n      if (typeof col.__excelTitle__ === 'string') {\n        value = col.__excelTitle__;\n      } else {\n        if (typeof col.title === 'string') {\n          value = col.title;\n        } else {\n          throw new Error('title must be a string, or use __excelTitle__');\n        }\n      }\n\n      var hMerge = colLen - 1;\n      var vMerge = 0;\n\n      if (!((_col$children = col.children) === null || _col$children === void 0 ? void 0 : _col$children.length)) {\n        vMerge = depth - 1 - y;\n      }\n\n      drawCell(cell, {\n        value: value,\n        hMerge: hMerge,\n        vMerge: vMerge,\n        style: _objectSpread2({\n          h: hMerge ? 'center' : 'left'\n        }, style)\n      });\n\n      if ((_col$children2 = col.children) === null || _col$children2 === void 0 ? void 0 : _col$children2.length) {\n        renderThead(excel, col.children, style, depth, x, y + 1);\n      }\n\n      x += hMerge ? hMerge + 1 : 1;\n    }\n  } catch (err) {\n    _iterator.e(err);\n  } finally {\n    _iterator.f();\n  }\n}\n/**\r\n * 获取column render的结果的参数\r\n * @param data column render的结果\r\n */\n\n\nfunction getColumnRenderValue(data) {\n  var o = {\n    children: '',\n    colSpan: 0,\n    rowSpan: 0,\n    __style__: {}\n  };\n\n  if (_typeof(data) !== 'object') {\n    o.children = data;\n    return o;\n  } // 单纯的react节点\n\n\n  if (data.$$typeof) {\n    o.children = getChildren(data);\n  } // 混合react节点和属性\n\n\n  if (data.children) {\n    if (_typeof(data.children) === 'object') {\n      o.children = getChildren(data.children);\n    } else {\n      o.children = data.children;\n    }\n  }\n\n  if (data.props) {\n    var _data$props, _data$props2;\n\n    o.colSpan = ((_data$props = data.props) === null || _data$props === void 0 ? void 0 : _data$props.colSpan) || 0;\n    o.rowSpan = ((_data$props2 = data.props) === null || _data$props2 === void 0 ? void 0 : _data$props2.rowSpan) || 0;\n\n    if (o.colSpan >= 1) {\n      o.colSpan -= 1;\n    }\n\n    if (o.rowSpan >= 1) {\n      o.rowSpan -= 1;\n    }\n  }\n\n  if (data.__style__) {\n    o.__style__ = data.__style__;\n  }\n\n  return o;\n}\n\nfunction getChildren(data) {\n  var _ref = data || {},\n      props = _ref.props;\n\n  if (typeof props.children === 'string') return props.children;\n  return props.children.reduce(function (prev, cur) {\n    if (typeof prev === 'string') {\n      return prev + ' ' + getChildren(cur);\n    }\n\n    return getChildren(prev) + ' ' + getChildren(cur);\n  }, '');\n}\n\nfunction getValueByStrPath(data, keys) {\n  if (_typeof(keys) !== 'object') return data[keys];\n\n  if (!Array.isArray(keys)) {\n    console.error('excel-dataIndex: Expected string or string[]');\n    return '';\n  }\n\n  var index = 0;\n  var key = keys[0];\n  var value = data;\n\n  try {\n    while (key) {\n      value = value[key];\n      index++;\n      key = keys[index];\n    }\n  } catch (e) {\n    return '';\n  }\n\n  if (_typeof(value) !== 'object') {\n    return value;\n  }\n\n  console.error('excel-cell-value: Unexpected object');\n  return '';\n}\n\nfunction renderTbody(excel, dataSource, allColumns) {\n  var config = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n  dataSource.forEach(function (data, index) {\n    var row = excel.addRow();\n    row.setHeightCM(excel.rowHeight);\n\n    for (var i = 0; i < allColumns.length; i++) {\n      var column = allColumns[i];\n\n      var dataIndex = column.dataIndex,\n          __cellType__ = column.__cellType__,\n          __numFmt__ = column.__numFmt__,\n          _column$__style__ = column.__style__,\n          __style__ = _column$__style__ === void 0 ? {} : _column$__style__;\n\n      var value = getValueByStrPath(data, dataIndex);\n      var cell = excel.sheet.cell(excel.currentRow - 1, excel.currentCol + i);\n      var hMerge = 0;\n      var vMerge = 0;\n      var renderValue = null;\n      var cellStyle = {};\n      var formula = void 0;\n\n      if (column.excelRender) {\n        renderValue = column.excelRender(value, data, index);\n      } else if (column.render) {\n        renderValue = column.render(value, data, index);\n      }\n\n      if (renderValue !== null) {\n        var _getColumnRenderValue = getColumnRenderValue(renderValue),\n            children = _getColumnRenderValue.children,\n            colSpan = _getColumnRenderValue.colSpan,\n            rowSpan = _getColumnRenderValue.rowSpan,\n            _style__ = _getColumnRenderValue.__style__;\n\n        value = children;\n        hMerge = colSpan;\n        vMerge = rowSpan;\n        cellStyle = _style__;\n\n        if (cellStyle && cellStyle.height) {\n          row.setHeightCM(cellStyle.height);\n        }\n      }\n\n      if (column.__cellType__ === \"TypeFormula\") {\n        formula = renderValue;\n      }\n\n      drawCell(cell, {\n        value: value,\n        formula: formula,\n        hMerge: hMerge,\n        vMerge: vMerge,\n        cellType: __cellType__,\n        numFmt: __numFmt__,\n        style: _objectSpread2(_objectSpread2(_objectSpread2({}, excel.defaultTbodyCellStyle), __style__), cellStyle)\n      }, config);\n    }\n  });\n}\n/**\r\n * 添加行\r\n * @param excel Excel实例\r\n * @param count 行数\r\n * @param height 行高(单位: CM)\r\n */\n\n\nfunction addRow(excel, start, count, height) {\n  for (var i = start; i < count + start; i++) {\n    var row = excel.addRow();\n\n    if (row.setHeightCM) {\n      row.setHeightCM(height);\n    }\n  }\n} // mac office 145px = 20cm\n\n\nfunction px2cm(px) {\n  return Math.floor(20 / 145 * px);\n}\n\nfunction addCol(excel, start, count, props) {\n  for (var i = start; i < count + start; i++) {\n    var col = excel.addCol();\n\n    if (col) {\n      drawCol(col, props[i - start]);\n    }\n  }\n}\n\nfunction drawCol(col, props) {\n  var _props$width = props.width,\n      width = _props$width === void 0 ? 150 : _props$width,\n      _props$align = props.align,\n      align = _props$align === void 0 ? 'left' : _props$align,\n      _props$__style__ = props.__style__,\n      __style__ = _props$__style__ === void 0 ? {} : _props$__style__,\n      __numFmt__ = props.__numFmt__;\n\n  if (width) {\n    col.width = px2cm(width);\n  }\n\n  if (__style__.width) {\n    col.width = __style__.width;\n  }\n\n  if (__numFmt__) {\n    col.numFmt = __numFmt__;\n  }\n\n  setStyle(col, _objectSpread2(_objectSpread2({}, __style__), {}, {\n    h: align\n  }));\n}\n\nvar Excel = /*#__PURE__*/function () {\n  function Excel() {\n    _classCallCheck(this, Excel);\n\n    this.file = void 0;\n    this.sheet = void 0;\n    this.columns = void 0;\n    this.currentRow = 0;\n    this.currentCol = 0;\n    this.defaultTheadCellStyle = {\n      background: 'FF88c849',\n      color: 'FF333333',\n      fontSize: 12,\n      bold: true,\n      border: true,\n      v: 'center',\n      wrapText: true\n    };\n    this.defaultTbodyCellStyle = {\n      v: 'bottom',\n      wrapText: true,\n      fontSize: 12\n    };\n    this.rowHeight = 1;\n    this.file = new File();\n  }\n  /**\r\n   * 添加工作表\r\n   * @param name 工作表名称\r\n   */\n\n\n  _createClass(Excel, [{\n    key: \"addSheet\",\n    value: function addSheet(name) {\n      if (!this.file) return this;\n      this.currentRow = 0;\n      this.currentCol = 0;\n      this.sheet = this.file.addSheet(name);\n      return this;\n    }\n    /**\r\n     * 添加一行\r\n     * @returns\r\n     */\n\n  }, {\n    key: \"addRow\",\n    value: function addRow() {\n      if (!this.sheet) {\n        throw new Error('please use addSheet before this');\n      }\n\n      this.currentRow++;\n      return this.sheet.row(this.sheet.maxRow);\n    }\n    /**\r\n     * 添加一列\r\n     * @returns\r\n     */\n\n  }, {\n    key: \"addCol\",\n    value: function addCol() {\n      if (!this.sheet) {\n        throw new Error('please use addSheet before this');\n      }\n\n      this.currentCol++;\n      return this.sheet.col(this.sheet.maxCol);\n    }\n  }, {\n    key: \"drawCell\",\n    value: function drawCell$1(x, y, props) {\n      if (!this.sheet) {\n        throw new Error('please use addSheet before this');\n      }\n\n      var vMerge = (props === null || props === void 0 ? void 0 : props.vMerge) || 0;\n      var rows = vMerge + 1;\n\n      if (this.currentRow < y + rows) {\n        for (var i = 0; i < rows; i++) {\n          this.addRow();\n        }\n      }\n\n      var cell = this.sheet.cell(y, x);\n      drawCell(cell, props);\n      return this;\n    }\n    /**\r\n     * 设置行高\r\n     * @param value number\r\n     * @param unit 单位 'cm' | 'px'，默认为px\r\n     */\n\n  }, {\n    key: \"setRowHeight\",\n    value: function setRowHeight(value) {\n      var unit = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'px';\n\n      if (typeof value !== 'number') {\n        throw new Error('value must be a number');\n      }\n\n      var v = value;\n\n      if (unit === 'px') {\n        v = px2cm(v);\n      }\n\n      this.rowHeight = v;\n      return this;\n    }\n    /**\r\n     * 添加表格配置\r\n     * @param columns antd table columns\r\n     * @param direction 'h' | 'v' 添加的方向，适用于追加表\r\n     */\n\n  }, {\n    key: \"addColumns\",\n    value: function addColumns(columns) {\n      if (!this.sheet) {\n        throw new Error('please use addSheet before this');\n      }\n\n      var x = this.currentCol;\n      var y = this.sheet.maxRow;\n      var filteredColumns = columnsFilter(columns);\n      var maxDepth = getColumnsMaxDepth(filteredColumns);\n      var maxLength = getColumnsMaxLength(filteredColumns);\n      var flatedColumns = flatColumns(filteredColumns);\n      addRow(this, this.currentRow, maxDepth, this.rowHeight);\n      addCol(this, this.currentCol, maxLength, flatedColumns);\n      renderThead(this, filteredColumns, this.defaultTheadCellStyle, y + maxDepth, x, y);\n      this.columns = filteredColumns;\n      this.currentCol -= maxLength;\n      return this;\n    }\n    /**\r\n     * 添加数据\r\n     * @param dataSource 数据\r\n     * @param config 表格体配置\r\n     */\n\n  }, {\n    key: \"addDataSource\",\n    value: function addDataSource(dataSource) {\n      var config = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      if (!this.sheet || !this.columns) {\n        throw new Error('please use addSheet and addColumns before this');\n      }\n\n      var flatedColumns = flatColumns(this.columns);\n      renderTbody(this, dataSource, flatedColumns, config);\n      return this;\n    }\n    /**\r\n     * 更改默认的表格头单元格样式属性，不包含表格体\r\n     * @param style 单元格样式属性\r\n     */\n\n  }, {\n    key: \"setTHeadStyle\",\n    value: function setTHeadStyle(style) {\n      this.defaultTheadCellStyle = _objectSpread2(_objectSpread2({}, this.defaultTheadCellStyle), style);\n      return this;\n    }\n    /**\r\n     * 更改默认的单元格样式属性，不包含表格头\r\n     * @param style 单元格样式属性\r\n     */\n\n  }, {\n    key: \"setTBodyStyle\",\n    value: function setTBodyStyle(style) {\n      this.defaultTbodyCellStyle = _objectSpread2(_objectSpread2({}, this.defaultTbodyCellStyle), style);\n      return this;\n    }\n    /**\r\n     * 另存为\r\n     * @param name 名称\r\n     * @param type 保存类型 'blob' | 'base64'\r\n     * @param compress 是否压缩 boolean\r\n     */\n\n  }, {\n    key: \"saveAs\",\n    value: function saveAs$1(name) {\n      var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'blob';\n      var compress = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n      if (!this.file) return;\n\n      if (type === 'blob') {\n        this.file.saveAs(type, compress).then(function (data) {\n          saveAs(data, name);\n        }).catch(function (e) {\n          console.error(e);\n        });\n      }\n    }\n  }]);\n\n  return Excel;\n}();\n\nexport { Excel };","map":{"version":3,"sources":["D:/class/cnWeb/QLNH/client_app/node_modules/antd-table-saveas-excel/dist/index.esm.js"],"names":["File","saveAs","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread2","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","_typeof","obj","Symbol","iterator","constructor","prototype","_classCallCheck","instance","Constructor","TypeError","_defineProperties","props","descriptor","configurable","writable","_createClass","protoProps","staticProps","value","_unsupportedIterableToArray","o","minLen","_arrayLikeToArray","n","toString","call","slice","name","Array","from","test","arr","len","arr2","_createForOfIteratorHelper","allowArrayLike","it","isArray","F","s","done","e","f","normalCompletion","didErr","err","step","next","return","getDefaultFontName","_navigator","navigator","isMac","userAgent","toLowerCase","STYLEMAP","border","cell","style","undefined","borderColor","top","topColor","right","rightColor","bottom","bottomColor","left","leftColor","background","fill","patternType","fgColor","bgColor","fontSize","font","size","fontName","color","bold","u","h","align","indent","shrinkToFit","textRotation","v","wrapText","setStyle","_i","_Object$keys","drawCell","config","_props$hMerge","hMerge","_props$vMerge","vMerge","numFmt","formula","cellType","_props$style","str2num","str2Percent","num","Number","isNaN","_num","String","replaceAll","isThousand","thousandToNumFmt","endsWith","_num2","percentToNumFmt","setFormula","setDate","Date","getDecimal","data","str","pointIndex","indexOf","decimalPart","decimal","numFmts","columnsFilter","columns","col","__ignore__","children","getColumnsMaxDepth","depth","maxs","map","getColumnDepth","Math","max","column","getColumnsMaxLength","reduce","prev","cur","getColumnLength","flatColumns","concat","flatColumn","renderThead","excel","x","y","_iterator","_step","_col$children","_col$children2","colLen","sheet","__excelTitle__","title","Error","getColumnRenderValue","colSpan","rowSpan","__style__","$$typeof","getChildren","_data$props","_data$props2","_ref","getValueByStrPath","console","error","index","renderTbody","dataSource","allColumns","row","addRow","setHeightCM","rowHeight","dataIndex","__cellType__","__numFmt__","_column$__style__","currentRow","currentCol","renderValue","cellStyle","excelRender","render","_getColumnRenderValue","_style__","height","defaultTbodyCellStyle","start","count","px2cm","px","floor","addCol","drawCol","_props$width","width","_props$align","_props$__style__","Excel","file","defaultTheadCellStyle","addSheet","maxRow","maxCol","drawCell$1","rows","setRowHeight","unit","addColumns","filteredColumns","maxDepth","maxLength","flatedColumns","addDataSource","setTHeadStyle","setTBodyStyle","saveAs$1","type","compress","then","catch"],"mappings":"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","sourcesContent":["import { File } from 'better-xlsx';\nimport { saveAs } from 'file-saver';\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n\n  return target;\n}\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n  return arr2;\n}\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) {\n  var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"];\n\n  if (!it) {\n    if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n      if (it) o = it;\n      var i = 0;\n\n      var F = function () {};\n\n      return {\n        s: F,\n        n: function () {\n          if (i >= o.length) return {\n            done: true\n          };\n          return {\n            done: false,\n            value: o[i++]\n          };\n        },\n        e: function (e) {\n          throw e;\n        },\n        f: F\n      };\n    }\n\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  var normalCompletion = true,\n      didErr = false,\n      err;\n  return {\n    s: function () {\n      it = it.call(o);\n    },\n    n: function () {\n      var step = it.next();\n      normalCompletion = step.done;\n      return step;\n    },\n    e: function (e) {\n      didErr = true;\n      err = e;\n    },\n    f: function () {\n      try {\n        if (!normalCompletion && it.return != null) it.return();\n      } finally {\n        if (didErr) throw err;\n      }\n    }\n  };\n}\n\nfunction getDefaultFontName() {\n  var _navigator;\n\n  if (typeof navigator === 'undefined') return 'Microsoft YaHei';\n  var isMac = /macintosh|mac os x/i.test((_navigator = navigator) === null || _navigator === void 0 ? void 0 : _navigator.userAgent.toLowerCase());\n  return isMac ? 'PingFang SC' : 'Microsoft YaHei';\n}\n\nvar STYLEMAP = {\n  border: function border(cell) {\n    var style = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var border = style.border;\n    var borderColor = style.borderColor || 'FF000000';\n    if (!border) return;\n    cell.style.border.top = 'thin';\n    cell.style.border.topColor = borderColor;\n    cell.style.border.right = 'thin';\n    cell.style.border.rightColor = borderColor;\n    cell.style.border.bottom = 'thin';\n    cell.style.border.bottomColor = borderColor;\n    cell.style.border.left = 'thin';\n    cell.style.border.leftColor = borderColor;\n  },\n  background: function background(cell) {\n    var style = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var background = style.background;\n\n    if (background) {\n      // FF 表示不透明 00 表示透明\n      // fg 前景色 bg 背景色\n      cell.style.fill.patternType = 'solid';\n      cell.style.fill.fgColor = background;\n      cell.style.fill.bgColor = 'ffffffff';\n    }\n  },\n  fontSize: function fontSize(cell) {\n    var style = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var fontSize = style.fontSize;\n\n    if (fontSize) {\n      cell.style.font.size = fontSize;\n    }\n  },\n  fontName: function fontName(cell) {\n    var style = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var fontName = style.fontName;\n\n    if (fontName) {\n      cell.style.font.name = fontName;\n    }\n  },\n  color: function color(cell) {\n    var style = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var color = style.color;\n\n    if (color) {\n      cell.style.font.color = color;\n    }\n  },\n  bold: function bold(cell) {\n    var style = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var bold = style.bold;\n\n    if (bold) {\n      cell.style.font.bold = bold;\n    }\n  },\n  i: function i(cell) {\n    var style = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var i = style.i;\n\n    if (i) {\n      cell.style.font.i = i;\n    }\n  },\n  u: function u(cell) {\n    var style = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var u = style.u;\n\n    if (u) {\n      cell.style.font.u = u;\n    }\n  },\n  h: function h(cell) {\n    var style = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var h = style.h;\n\n    if (h) {\n      cell.style.align.h = h;\n    }\n  },\n  indent: function indent(cell) {\n    var style = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var indent = style.indent;\n\n    if (indent) {\n      cell.style.align.indent = indent;\n    }\n  },\n  shrinkToFit: function shrinkToFit(cell) {\n    var style = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var shrinkToFit = style.shrinkToFit;\n\n    if (shrinkToFit) {\n      cell.style.align.shrinkToFit = shrinkToFit;\n    }\n  },\n  textRotation: function textRotation(cell) {\n    var style = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var textRotation = style.textRotation;\n\n    if (textRotation) {\n      cell.style.align.textRotation = textRotation;\n    }\n  },\n  v: function v(cell) {\n    var style = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var v = style.v;\n\n    if (v) {\n      cell.style.align.v = v;\n    }\n  },\n  wrapText: function wrapText(cell) {\n    var style = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var wrapText = style.wrapText;\n\n    if (wrapText) {\n      cell.style.align.wrapText = wrapText;\n    }\n  }\n};\n\nfunction setStyle(cell) {\n  var style = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var fontName = style.fontName;\n\n  if (!fontName) {\n    cell.style.font.name = getDefaultFontName();\n  }\n\n  for (var _i = 0, _Object$keys = Object.keys(style); _i < _Object$keys.length; _i++) {\n    var key = _Object$keys[_i];\n\n    if (key in STYLEMAP) {\n      //@ts-ignore\n      STYLEMAP[key](cell, style);\n    }\n  }\n}\n\nfunction drawCell(cell, props) {\n  var config = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  var value = props.value,\n      _props$hMerge = props.hMerge,\n      hMerge = _props$hMerge === void 0 ? 0 : _props$hMerge,\n      _props$vMerge = props.vMerge,\n      vMerge = _props$vMerge === void 0 ? 0 : _props$vMerge,\n      numFmt = props.numFmt,\n      formula = props.formula,\n      cellType = props.cellType,\n      _props$style = props.style,\n      style = _props$style === void 0 ? {} : _props$style;\n  var str2num = config.str2num,\n      str2Percent = config.str2Percent; // 尝试将值转化为数字\n\n  if (str2num) {\n    var num = Number(value);\n\n    if (!isNaN(num)) {\n      cell.value = num;\n    } else {\n      // 可能是千分位\n      var _num = String(value).replaceAll(',', '');\n\n      var isThousand = !isNaN(Number(_num));\n\n      if (isThousand) {\n        cell.value = Number(_num);\n        cell.numFmt = thousandToNumFmt(_num);\n      } else {\n        cell.value = value;\n      }\n    }\n  } else {\n    cell.value = value;\n  }\n\n  if (str2Percent && String(value).endsWith('%')) {\n    // 可以转化为百分比的话进行设置\n    var _num2 = Number(String(value).slice(0, -1));\n\n    if (!isNaN(_num2)) {\n      cell.value = Number(_num2) / 100;\n      cell.numFmt = percentToNumFmt(_num2);\n    }\n  } // 声明了公式\n\n\n  if (formula) {\n    cell.setFormula(formula);\n    return;\n  } // 指定了单元格类型\n\n\n  if (cellType) {\n    if (cellType === 'TypeDate') {\n      cell.setDate(new Date(value));\n    } else {\n      cell.cellType = cellType;\n    } // return;\n\n  } // 指定了单元格格式\n\n\n  if (numFmt) {\n    cell.numFmt = numFmt;\n  } // 合并\n\n\n  cell.hMerge = hMerge;\n  cell.vMerge = vMerge;\n\n  if (vMerge) {\n    style.v = 'center';\n  }\n\n  setStyle(cell, style);\n}\n\nfunction getDecimal(data) {\n  var str = String(data);\n  var pointIndex = str.indexOf('.');\n  if (pointIndex === -1) return 0;\n  var decimalPart = str.slice(pointIndex + 1);\n  return decimalPart.length;\n}\n\nfunction thousandToNumFmt(data) {\n  var decimal = getDecimal(data);\n  var numFmts = ['#,##0', '#,##0.0', '#,##0.00', '#,##0.000', '#,##0.0000'];\n  return numFmts[decimal] || numFmts[4];\n}\n\nfunction percentToNumFmt(data) {\n  var decimal = getDecimal(data);\n  var numFmts = ['0%', '0.0%', '0.00%', '0.000%', '0.0000%'];\n  return numFmts[decimal] || numFmts[2];\n}\n\n// export interface ITreeNode {\n//   title: string;\n//   x: number;\n//   xMerge: number;\n//   vMerge: number;\n//   children: ITreeNode[] | null;\n// }\nfunction columnsFilter(columns) {\n  return columns.filter(function (col) {\n    if (col.__ignore__) return false;\n\n    if (col.children) {\n      col.children = columnsFilter(col.children);\n    }\n\n    return true;\n  });\n}\nfunction getColumnsMaxDepth(columns) {\n  var depth = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n  var maxs = columns.map(function (col) {\n    return getColumnDepth(col, depth);\n  });\n  return Math.max.apply(Math, maxs);\n}\n\nfunction getColumnDepth(column) {\n  var depth = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n\n  if (column.children) {\n    return getColumnsMaxDepth(column.children, depth + 1);\n  }\n\n  return depth;\n}\n\nfunction getColumnsMaxLength(columns) {\n  return columns.reduce(function (prev, cur) {\n    return prev + getColumnLength(cur);\n  }, 0);\n}\n\nfunction getColumnLength(column) {\n  if (column.children) {\n    return getColumnsMaxLength(column.children);\n  }\n\n  return 1;\n}\n\nfunction flatColumns(columns) {\n  return columns.reduce(function (prev, cur) {\n    return prev.concat(flatColumn(cur));\n  }, []);\n}\n\nfunction flatColumn(column) {\n  if (column.children) {\n    return flatColumns(column.children);\n  }\n\n  return [column];\n}\n\n/**\r\n * 渲染表格头\r\n * @param excel TExcel\r\n * @param columns 传入的表头配置，antd table columns props\r\n * @param style 表头样式\r\n * @param depth 表头深度\r\n * @param x 开始绘制的单元格，第几列\r\n * @param y 开始绘制的单元格，第几行\r\n */\n\nfunction renderThead(excel, columns, style, depth) {\n  var x = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 0;\n  var y = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 0;\n\n  var _iterator = _createForOfIteratorHelper(columns),\n      _step;\n\n  try {\n    for (_iterator.s(); !(_step = _iterator.n()).done;) {\n      var _col$children, _col$children2;\n\n      var col = _step.value;\n      var colLen = getColumnsMaxLength([col]);\n      var cell = excel.sheet.cell(y, x);\n      var value = '';\n\n      if (typeof col.__excelTitle__ === 'string') {\n        value = col.__excelTitle__;\n      } else {\n        if (typeof col.title === 'string') {\n          value = col.title;\n        } else {\n          throw new Error('title must be a string, or use __excelTitle__');\n        }\n      }\n\n      var hMerge = colLen - 1;\n      var vMerge = 0;\n\n      if (!((_col$children = col.children) === null || _col$children === void 0 ? void 0 : _col$children.length)) {\n        vMerge = depth - 1 - y;\n      }\n\n      drawCell(cell, {\n        value: value,\n        hMerge: hMerge,\n        vMerge: vMerge,\n        style: _objectSpread2({\n          h: hMerge ? 'center' : 'left'\n        }, style)\n      });\n\n      if ((_col$children2 = col.children) === null || _col$children2 === void 0 ? void 0 : _col$children2.length) {\n        renderThead(excel, col.children, style, depth, x, y + 1);\n      }\n\n      x += hMerge ? hMerge + 1 : 1;\n    }\n  } catch (err) {\n    _iterator.e(err);\n  } finally {\n    _iterator.f();\n  }\n}\n\n/**\r\n * 获取column render的结果的参数\r\n * @param data column render的结果\r\n */\nfunction getColumnRenderValue(data) {\n  var o = {\n    children: '',\n    colSpan: 0,\n    rowSpan: 0,\n    __style__: {}\n  };\n\n  if (_typeof(data) !== 'object') {\n    o.children = data;\n    return o;\n  } // 单纯的react节点\n\n\n  if (data.$$typeof) {\n    o.children = getChildren(data);\n  } // 混合react节点和属性\n\n\n  if (data.children) {\n    if (_typeof(data.children) === 'object') {\n      o.children = getChildren(data.children);\n    } else {\n      o.children = data.children;\n    }\n  }\n\n  if (data.props) {\n    var _data$props, _data$props2;\n\n    o.colSpan = ((_data$props = data.props) === null || _data$props === void 0 ? void 0 : _data$props.colSpan) || 0;\n    o.rowSpan = ((_data$props2 = data.props) === null || _data$props2 === void 0 ? void 0 : _data$props2.rowSpan) || 0;\n\n    if (o.colSpan >= 1) {\n      o.colSpan -= 1;\n    }\n\n    if (o.rowSpan >= 1) {\n      o.rowSpan -= 1;\n    }\n  }\n\n  if (data.__style__) {\n    o.__style__ = data.__style__;\n  }\n\n  return o;\n}\n\nfunction getChildren(data) {\n  var _ref = data || {},\n      props = _ref.props;\n\n  if (typeof props.children === 'string') return props.children;\n  return props.children.reduce(function (prev, cur) {\n    if (typeof prev === 'string') {\n      return prev + ' ' + getChildren(cur);\n    }\n\n    return getChildren(prev) + ' ' + getChildren(cur);\n  }, '');\n}\n\nfunction getValueByStrPath(data, keys) {\n  if (_typeof(keys) !== 'object') return data[keys];\n\n  if (!Array.isArray(keys)) {\n    console.error('excel-dataIndex: Expected string or string[]');\n    return '';\n  }\n\n  var index = 0;\n  var key = keys[0];\n  var value = data;\n\n  try {\n    while (key) {\n      value = value[key];\n      index++;\n      key = keys[index];\n    }\n  } catch (e) {\n    return '';\n  }\n\n  if (_typeof(value) !== 'object') {\n    return value;\n  }\n\n  console.error('excel-cell-value: Unexpected object');\n  return '';\n}\n\nfunction renderTbody(excel, dataSource, allColumns) {\n  var config = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n  dataSource.forEach(function (data, index) {\n    var row = excel.addRow();\n    row.setHeightCM(excel.rowHeight);\n\n    for (var i = 0; i < allColumns.length; i++) {\n      var column = allColumns[i];\n\n      var dataIndex = column.dataIndex,\n          __cellType__ = column.__cellType__,\n          __numFmt__ = column.__numFmt__,\n          _column$__style__ = column.__style__,\n          __style__ = _column$__style__ === void 0 ? {} : _column$__style__;\n\n      var value = getValueByStrPath(data, dataIndex);\n      var cell = excel.sheet.cell(excel.currentRow - 1, excel.currentCol + i);\n      var hMerge = 0;\n      var vMerge = 0;\n      var renderValue = null;\n      var cellStyle = {};\n      var formula = void 0;\n\n      if (column.excelRender) {\n        renderValue = column.excelRender(value, data, index);\n      } else if (column.render) {\n        renderValue = column.render(value, data, index);\n      }\n\n      if (renderValue !== null) {\n        var _getColumnRenderValue = getColumnRenderValue(renderValue),\n            children = _getColumnRenderValue.children,\n            colSpan = _getColumnRenderValue.colSpan,\n            rowSpan = _getColumnRenderValue.rowSpan,\n            _style__ = _getColumnRenderValue.__style__;\n\n        value = children;\n        hMerge = colSpan;\n        vMerge = rowSpan;\n        cellStyle = _style__;\n\n        if (cellStyle && cellStyle.height) {\n          row.setHeightCM(cellStyle.height);\n        }\n      }\n\n      if (column.__cellType__ === \"TypeFormula\") {\n        formula = renderValue;\n      }\n\n      drawCell(cell, {\n        value: value,\n        formula: formula,\n        hMerge: hMerge,\n        vMerge: vMerge,\n        cellType: __cellType__,\n        numFmt: __numFmt__,\n        style: _objectSpread2(_objectSpread2(_objectSpread2({}, excel.defaultTbodyCellStyle), __style__), cellStyle)\n      }, config);\n    }\n  });\n}\n\n/**\r\n * 添加行\r\n * @param excel Excel实例\r\n * @param count 行数\r\n * @param height 行高(单位: CM)\r\n */\nfunction addRow(excel, start, count, height) {\n  for (var i = start; i < count + start; i++) {\n    var row = excel.addRow();\n\n    if (row.setHeightCM) {\n      row.setHeightCM(height);\n    }\n  }\n}\n\n// mac office 145px = 20cm\nfunction px2cm(px) {\n  return Math.floor(20 / 145 * px);\n}\n\nfunction addCol(excel, start, count, props) {\n  for (var i = start; i < count + start; i++) {\n    var col = excel.addCol();\n\n    if (col) {\n      drawCol(col, props[i - start]);\n    }\n  }\n}\n\nfunction drawCol(col, props) {\n  var _props$width = props.width,\n      width = _props$width === void 0 ? 150 : _props$width,\n      _props$align = props.align,\n      align = _props$align === void 0 ? 'left' : _props$align,\n      _props$__style__ = props.__style__,\n      __style__ = _props$__style__ === void 0 ? {} : _props$__style__,\n      __numFmt__ = props.__numFmt__;\n\n  if (width) {\n    col.width = px2cm(width);\n  }\n\n  if (__style__.width) {\n    col.width = __style__.width;\n  }\n\n  if (__numFmt__) {\n    col.numFmt = __numFmt__;\n  }\n\n  setStyle(col, _objectSpread2(_objectSpread2({}, __style__), {}, {\n    h: align\n  }));\n}\n\nvar Excel = /*#__PURE__*/function () {\n  function Excel() {\n    _classCallCheck(this, Excel);\n\n    this.file = void 0;\n    this.sheet = void 0;\n    this.columns = void 0;\n    this.currentRow = 0;\n    this.currentCol = 0;\n    this.defaultTheadCellStyle = {\n      background: 'FF88c849',\n      color: 'FF333333',\n      fontSize: 12,\n      bold: true,\n      border: true,\n      v: 'center',\n      wrapText: true\n    };\n    this.defaultTbodyCellStyle = {\n      v: 'bottom',\n      wrapText: true,\n      fontSize: 12\n    };\n    this.rowHeight = 1;\n    this.file = new File();\n  }\n  /**\r\n   * 添加工作表\r\n   * @param name 工作表名称\r\n   */\n\n\n  _createClass(Excel, [{\n    key: \"addSheet\",\n    value: function addSheet(name) {\n      if (!this.file) return this;\n      this.currentRow = 0;\n      this.currentCol = 0;\n      this.sheet = this.file.addSheet(name);\n      return this;\n    }\n    /**\r\n     * 添加一行\r\n     * @returns\r\n     */\n\n  }, {\n    key: \"addRow\",\n    value: function addRow() {\n      if (!this.sheet) {\n        throw new Error('please use addSheet before this');\n      }\n      this.currentRow++;\n      return this.sheet.row(this.sheet.maxRow);\n    }\n    /**\r\n     * 添加一列\r\n     * @returns\r\n     */\n\n  }, {\n    key: \"addCol\",\n    value: function addCol() {\n      if (!this.sheet) {\n        throw new Error('please use addSheet before this');\n      }\n      this.currentCol++;\n      return this.sheet.col(this.sheet.maxCol);\n    }\n  }, {\n    key: \"drawCell\",\n    value: function drawCell$1(x, y, props) {\n      if (!this.sheet) {\n        throw new Error('please use addSheet before this');\n      }\n      var vMerge = (props === null || props === void 0 ? void 0 : props.vMerge) || 0;\n      var rows = vMerge + 1;\n\n      if (this.currentRow < y + rows) {\n        for (var i = 0; i < rows; i++) {\n          this.addRow();\n        }\n      }\n\n      var cell = this.sheet.cell(y, x);\n\n      drawCell(cell, props);\n\n      return this;\n    }\n    /**\r\n     * 设置行高\r\n     * @param value number\r\n     * @param unit 单位 'cm' | 'px'，默认为px\r\n     */\n\n  }, {\n    key: \"setRowHeight\",\n    value: function setRowHeight(value) {\n      var unit = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'px';\n\n      if (typeof value !== 'number') {\n        throw new Error('value must be a number');\n      }\n\n      var v = value;\n\n      if (unit === 'px') {\n        v = px2cm(v);\n      }\n\n      this.rowHeight = v;\n      return this;\n    }\n    /**\r\n     * 添加表格配置\r\n     * @param columns antd table columns\r\n     * @param direction 'h' | 'v' 添加的方向，适用于追加表\r\n     */\n\n  }, {\n    key: \"addColumns\",\n    value: function addColumns(columns) {\n      if (!this.sheet) {\n        throw new Error('please use addSheet before this');\n      }\n\n      var x = this.currentCol;\n      var y = this.sheet.maxRow;\n      var filteredColumns = columnsFilter(columns);\n      var maxDepth = getColumnsMaxDepth(filteredColumns);\n      var maxLength = getColumnsMaxLength(filteredColumns);\n      var flatedColumns = flatColumns(filteredColumns);\n      addRow(this, this.currentRow, maxDepth, this.rowHeight);\n      addCol(this, this.currentCol, maxLength, flatedColumns);\n      renderThead(this, filteredColumns, this.defaultTheadCellStyle, y + maxDepth, x, y);\n      this.columns = filteredColumns;\n      this.currentCol -= maxLength;\n      return this;\n    }\n    /**\r\n     * 添加数据\r\n     * @param dataSource 数据\r\n     * @param config 表格体配置\r\n     */\n\n  }, {\n    key: \"addDataSource\",\n    value: function addDataSource(dataSource) {\n      var config = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      if (!this.sheet || !this.columns) {\n        throw new Error('please use addSheet and addColumns before this');\n      }\n      var flatedColumns = flatColumns(this.columns);\n      renderTbody(this, dataSource, flatedColumns, config);\n      return this;\n    }\n    /**\r\n     * 更改默认的表格头单元格样式属性，不包含表格体\r\n     * @param style 单元格样式属性\r\n     */\n\n  }, {\n    key: \"setTHeadStyle\",\n    value: function setTHeadStyle(style) {\n      this.defaultTheadCellStyle = _objectSpread2(_objectSpread2({}, this.defaultTheadCellStyle), style);\n      return this;\n    }\n    /**\r\n     * 更改默认的单元格样式属性，不包含表格头\r\n     * @param style 单元格样式属性\r\n     */\n\n  }, {\n    key: \"setTBodyStyle\",\n    value: function setTBodyStyle(style) {\n      this.defaultTbodyCellStyle = _objectSpread2(_objectSpread2({}, this.defaultTbodyCellStyle), style);\n      return this;\n    }\n    /**\r\n     * 另存为\r\n     * @param name 名称\r\n     * @param type 保存类型 'blob' | 'base64'\r\n     * @param compress 是否压缩 boolean\r\n     */\n\n  }, {\n    key: \"saveAs\",\n    value: function saveAs$1(name) {\n      var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'blob';\n      var compress = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n      if (!this.file) return;\n\n      if (type === 'blob') {\n        this.file.saveAs(type, compress).then(function (data) {\n          saveAs(data, name);\n        }).catch(function (e) {\n          console.error(e);\n        });\n      }\n    }\n  }]);\n\n  return Excel;\n}();\n\nexport { Excel };\n"]},"metadata":{},"sourceType":"module"}